I"èV<p>åœ¨ Java ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç±»å‹ä¿¡æ¯éƒ½èƒ½åœ¨ç¼–è¯‘é˜¶æ®µæ˜ç¡®ï¼Œæœ‰ä¸€äº›ç±»å‹ä¿¡æ¯éœ€è¦åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šï¼Œè¿™ç§æœºåˆ¶è¢«ç§°ä¸º RTTIï¼Œè‹±æ–‡å…¨ç§°ä¸º <code class="highlighter-rouge">Run-Time Type Identification</code>ï¼Œå³è¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼Œæœ‰æ²¡æœ‰ä¸€ç‚¹â€œçŸ¥è¡Œåˆä¸€â€çš„å‘³é“ï¼Ÿè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ä¸»è¦ç”±Classç±»å®ç°ã€‚</p>

<!--more-->

<blockquote>
  <p>Javaæ³¨è§£æ˜¯ä¸€ç³»åˆ—å…ƒæ•°æ®ï¼Œå®ƒæä¾›æ•°æ®ç”¨æ¥è§£é‡Šç¨‹åºä»£ç ï¼Œä½†æ˜¯æ³¨è§£å¹¶éæ˜¯æ‰€è§£é‡Šçš„ä»£ç æœ¬èº«çš„ä¸€éƒ¨åˆ†ã€‚æ³¨è§£å¯¹äºä»£ç çš„è¿è¡Œæ•ˆæœæ²¡æœ‰ç›´æ¥å½±å“ã€‚</p>
</blockquote>

<p>ç½‘ç»œä¸Šå¯¹æ³¨è§£çš„è§£é‡Šè¿‡äºä¸¥è‚ƒã€åˆ»æ¿ï¼Œè¿™å¹¶ä¸æ˜¯<a href="https://mp.weixin.qq.com/s/feoOINGSyivBO8Z1gaQVOA">æˆ‘</a>å–œæ¬¢çš„é£æ ¼ã€‚å°½ç®¡è¿™æ ·çš„è§£é‡Šå¬èµ·æ¥éå¸¸çš„ä¸“ä¸šã€‚</p>

<p>ä¸ºäº†ç¼“è§£å¤§å®¶å¯¹â€œæ³¨è§£â€çš„é™Œç”Ÿæ„Ÿï¼Œæˆ‘æ¥è¯´ç‚¹æœ‰æ„æ€çš„ã€‚å…¶å®æˆ‘å¯¹â€œæ³¨è§£â€è¿™ä¸ªè¯çš„ç¬¬ä¸€å°è±¡å¹¶ä¸æ˜¯Javaçš„æ³¨è§£ï¼Œè€Œæ˜¯æœ±ç†¹çš„åä½œã€Šå››ä¹¦ç« å¥é›†æ³¨ã€‹ã€‚ä¸ºä»€ä¹ˆæˆ‘ä¼šæœ‰è¿™ä¹ˆå¤§çš„è„‘æ´å‘¢ï¼Ÿå› ä¸ºå½“æˆ‘è¯•ç€å»ç¿»è¯‘<code class="highlighter-rouge">Annotation</code>è¿™ä¸ªå•è¯çš„æ—¶å€™ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯â€œæ³¨é‡Šâ€è€Œä¸æ˜¯â€œæ³¨è§£â€ã€‚ã€Šå››ä¹¦ç« å¥é›†æ³¨ã€‹æ­£æ˜¯æœ±ç†¹å¯¹ã€Šå¤§å­¦ã€‹ã€ã€Šä¸­åº¸ã€‹ã€ã€Šè®ºè¯­ã€‹ã€ã€Šå­Ÿå­ã€‹å››ä¹¦åšå‡ºçš„é‡è¦çš„æ³¨é‡Šã€‚è¦çŸ¥é“ï¼Œè¯¥ä¹¦å¯æ˜¯æ˜æ¸…ä»¥åç§‘ä¸¾è€ƒè¯•çš„é¢˜åº“å’Œæ ‡å‡†ç­”æ¡ˆï¼</p>

<p>æ³¨è§£ï¼ˆ<code class="highlighter-rouge">Annotation</code>ï¼‰æ˜¯åœ¨ Java SE 5.0 ç‰ˆæœ¬ä¸­å¼€å§‹å¼•å…¥çš„æ¦‚å¿µï¼ŒåŒ<code class="highlighter-rouge">class</code>å’Œ<code class="highlighter-rouge">interface</code>ä¸€æ ·ï¼Œä¹Ÿå±äºä¸€ç§ç±»å‹ã€‚å¾ˆå¤šå¼€å‘äººå‘˜è®¤ä¸ºæ³¨è§£çš„åœ°ä½ä¸é«˜ï¼Œä½†å…¶å®ä¸æ˜¯è¿™æ ·çš„ã€‚åƒ<code class="highlighter-rouge">@Transactional</code>ã€<code class="highlighter-rouge">@Service</code>ã€<code class="highlighter-rouge">@RestController</code>ã€<code class="highlighter-rouge">@RequestMapping</code>ã€<code class="highlighter-rouge">@CrossOrigin</code>ç­‰ç­‰è¿™äº›æ³¨è§£çš„ä½¿ç”¨é¢‘ç‡è¶Šæ¥è¶Šé«˜ã€‚</p>

<h3 id="01ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³¨è§£å‘¢">01ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³¨è§£å‘¢ï¼Ÿ</h3>

<p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³¨è§£å‘¢ï¼Ÿè®©æˆ‘ä»¬ä»å¦å¤–ä¸€ä¸ªé—®é¢˜è¯´èµ·ã€‚</p>

<p>â€œè·¨åŸŸâ€è¿™ä¸¤ä¸ªå­—å°±åƒä¸€å—ç‹—çš®è†è¯é»åœ¨æ¯ä¸€ä¸ªå‰ç«¯å¼€å‘è€…çš„èº«ä¸Šï¼›æˆ‘ä¹Ÿä¸ä¾‹å¤–ï¼Œè™½ç„¶æˆ‘å¹¶ä¸æ˜¯ä¸€ä¸ªçº¯ç²¹çš„å‰ç«¯å¼€å‘è€…ã€‚</p>

<p>è·¨åŸŸé—®é¢˜çš„å‡ºç°ï¼Œæºäºæµè§ˆå™¨çš„åŒæºç­–ç•¥â€”â€”é™åˆ¶ä¸€ä¸ªæºåŠ è½½çš„è„šæœ¬å»è®¿é—®å¦å¤–ä¸€ä¸ªæºçš„èµ„æºï¼Œå¯æœ‰æ•ˆåœ°éš”ç¦»æ½œåœ¨çš„æ¶æ„æ–‡ä»¶ï¼Œæ˜¯ä¸€ç§é‡è¦çš„å®‰å…¨æœºåˆ¶ã€‚</p>

<p><img src="http://www.itwanger.com/assets/images/2019/11/java-annotation-1.png" alt="" /></p>

<p>è·¨åŸŸé—®é¢˜çš„è§£å†³æ–¹æ¡ˆä¹Ÿæœ‰å¾ˆå¤šï¼Œæ¯”å¦‚è¯´ï¼š</p>

<p>1ï¼‰JSONP</p>

<p>2ï¼‰Nginxä»£ç†</p>

<p>3ï¼‰â€è·¨åŸŸèµ„æºå…±äº«â€ï¼ˆCross-origin resource sharingï¼‰ï¼Œç®€ç§°<code class="highlighter-rouge">CORS</code>ï¼Œå¯ä»¥è¯´æ˜¯å¤„ç†è·¨åŸŸé—®é¢˜çš„æ ‡å‡†åšæ³•ã€‚</p>

<p>è®°å¾—ç¬¬ä¸€æ¬¡é‡åˆ°è·¨åŸŸé—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ç‰¹æ„å‘ä¸€ä¸ªåŒå­¦è¯·æ•™äº†è§£å†³æ–¹æ¡ˆï¼Œä»–å‘Šè¯‰æˆ‘çš„ç­”æ¡ˆå¦‚ä¸‹ã€‚</p>

<p>ç¬¬ä¸€æ­¥ï¼Œåœ¨web.xmlæ·»åŠ filterã€‚</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;filter&gt;</span>
  <span class="nt">&lt;filter-name&gt;</span>contextfilter<span class="nt">&lt;/filter-name&gt;</span>
  <span class="nt">&lt;filter-class&gt;</span>com.cmower.filter.WebContextFilter<span class="nt">&lt;/filter-class&gt;</span>
<span class="nt">&lt;/filter&gt;</span>
<span class="nt">&lt;filter-mapping&gt;</span>
  <span class="nt">&lt;filter-name&gt;</span>contextfilter<span class="nt">&lt;/filter-name&gt;</span>
  <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/filter-mapping&gt;</span>
</code></pre></div></div>

<p>ç¬¬äºŒæ­¥ï¼Œå®ç°WebContextFilterç±»ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebContextFilter</span> <span class="kd">implements</span> <span class="nc">Filter</span> <span class="o">{</span>
 
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>
 
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doFilter</span><span class="o">(</span><span class="nc">ServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">ServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">FilterChain</span> <span class="n">chain</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">IOException</span><span class="o">,</span> <span class="nc">ServletException</span> <span class="o">{</span>
        <span class="nc">HttpServletResponse</span>  <span class="n">httpServletResponse</span> <span class="o">=</span> <span class="o">(</span><span class="nc">HttpServletResponse</span><span class="o">)</span> <span class="n">response</span><span class="o">;</span>
        <span class="n">httpServletResponse</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Origin"</span><span class="o">,</span> <span class="s">"*"</span><span class="o">);</span>
        <span class="n">httpServletResponse</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Headers"</span><span class="o">,</span> <span class="s">"accept,content-type"</span><span class="o">);</span> 
        <span class="n">httpServletResponse</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Methods"</span><span class="o">,</span> <span class="s">"OPTIONS,GET,POST,DELETE,PUT"</span><span class="o">);</span> 
        <span class="n">chain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">httpServletResponse</span><span class="o">);</span>
         
    <span class="o">}</span>
 
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">FilterConfig</span> <span class="n">arg0</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span> <span class="o">{</span>
    <span class="o">}</span>
 
<span class="o">}</span>
</code></pre></div></div>

<p>çœ‹åˆ°è¿™æ ·çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘çœŸçš„æ˜¯è›®å´©æºƒçš„ã€‚ä¸å°±ä¸€ä¸ªè·¨åŸŸé—®é¢˜å˜›ï¼Œç”¨å¾—ç€è¿™ä¹ˆå¤šä»£ç å—ï¼Ÿ</p>

<p>æˆ‘å¯¹è¿™æ ·çš„è§£å†³æ–¹æ¡ˆéå¸¸çš„ä¸æ»¡æ„ã€‚äºæ˜¯ä¸‹å®šå†³å¿ƒè¦å¥½å¥½çš„ç ”ç©¶ä¸€ç•ªï¼Œå¤§æ¦‚èŠ±äº†åŠå¤©çš„æ—¶é—´å§ï¼Œæˆ‘ç»ˆäºææ¸…æ¥šäº†â€œè·¨åŸŸâ€é—®é¢˜ï¼Œä»¥åŠå®ƒçš„æ ‡å‡†è§£å†³æ–¹æ¡ˆ<code class="highlighter-rouge">CORS</code>ã€‚å¹¶ä¸”æ‰¾åˆ°äº†ä¸€ä¸ªæä¸ºç®€æ´çš„è§£å†³æ–¹æ¡ˆâ€”â€”<code class="highlighter-rouge">@CrossOrigin</code>ï¼Œåªè¦åœ¨Controllerç±»ä¸ŠåŠ ä¸Šè¿™ä¸ªæ³¨è§£ï¼Œå°±å¯ä»¥è½»æ¾åœ°è§£å†³è·¨åŸŸé—®é¢˜ã€‚</p>

<p>ä»£ç å¦‚ä¸‹ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"course"</span><span class="o">)</span>
<span class="nd">@CrossOrigin</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CourseController</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>

<p>å¦‚æœæ²¡æœ‰æ‰¾åˆ°<code class="highlighter-rouge">@CrossOrigin</code>è¿™ä¸ªæ³¨è§£ï¼Œæˆ‘çœŸçš„å°±è¦æŒ‰ç…§åŒå­¦æä¾›çš„æ–¹æ¡ˆå»è§£å†³è·¨åŸŸçš„é—®é¢˜äº†ã€‚ä½†é‚£æ ·åšå°±å¥½åƒï¼Œæˆ‘ä»¬å–æ‰å®¶é‡Œçš„å°æ±½è½¦ï¼Œç„¶åå‡ºè¡Œçš„æ—¶å€™é©¾ä¸€è¾†é©¬è½¦ä¸€æ ·ã€‚</p>

<p>è¿™ä¹Ÿæ­£æ˜¯æˆ‘æƒ³å‘Šè¯‰ä½ çš„ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³¨è§£çš„åŸå› ï¼šå®ƒè®©æˆ‘ä»¬çš„ä»£ç çœ‹èµ·æ¥æ›´ç®€æ´ï¼Œæ›´æœ‰æ—¶ä»£çš„è¿›æ­¥æ„Ÿã€‚</p>

<h3 id="02è¯¥å¦‚ä½•å®šä¹‰æ³¨è§£å‘¢">02ã€è¯¥å¦‚ä½•å®šä¹‰æ³¨è§£å‘¢ï¼Ÿ</h3>

<p>æ³¨è§£éœ€è¦é€šè¿‡<code class="highlighter-rouge">@interface</code>å…³é”®å­—ï¼ˆå½¢å¼å’Œæ¥å£éå¸¸çš„ç›¸ä¼¼ï¼Œåªæ˜¯å‰é¢å¤šäº†ä¸€ä¸ª<code class="highlighter-rouge">@</code>ï¼‰è¿›è¡Œå®šä¹‰ã€‚æˆ‘ä»¬å¯ä»¥æ‰“å¼€<code class="highlighter-rouge">@CrossOrigin</code>çš„æºç æ¥çœ‹ä¸€ä¸‹ã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Target</span><span class="o">({</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">,</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE</span> <span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">CrossOrigin</span> <span class="o">{</span>
	<span class="cm">/**
	 * List of allowed origins, e.g. {@code "http://domain1.com"}.
	 * &lt;p&gt;These values are placed in the {@code Access-Control-Allow-Origin}
	 * header of both the pre-flight response and the actual response.
	 * {@code "*"} means that all origins are allowed.
	 * &lt;p&gt;If undefined, all origins are allowed.
	 * @see #value
	 */</span>
	<span class="nd">@AliasFor</span><span class="o">(</span><span class="s">"value"</span><span class="o">)</span>
	<span class="nc">String</span><span class="o">[]</span> <span class="nf">origins</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>
	<span class="cm">/**
	 * List of request headers that can be used during the actual request.
	 * &lt;p&gt;This property controls the value of the pre-flight response's
	 * {@code Access-Control-Allow-Headers} header.
	 * {@code "*"}  means that all headers requested by the client are allowed.
	 * &lt;p&gt;If undefined, all requested headers are allowed.
	 */</span>
	<span class="nc">String</span><span class="o">[]</span> <span class="nf">allowedHeaders</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>
	<span class="cm">/**
	 * List of supported HTTP request methods, e.g.
	 * {@code "{RequestMethod.GET, RequestMethod.POST}"}.
	 * &lt;p&gt;Methods specified here override those specified via {@code RequestMapping}.
	 * &lt;p&gt;If undefined, methods defined by {@link RequestMapping} annotation
	 * are used.
	 */</span>
	<span class="nc">RequestMethod</span><span class="o">[]</span> <span class="nf">methods</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å¾—å‡ºæ¥ï¼Œâ€œæ³¨è§£â€çœŸçš„å¾ˆâ€œæ³¨è§£â€ï¼Œé™¤äº†æ³¨é‡Šå¤šå’Œâ€œå…ƒæ³¨è§£â€å¤šä¹‹å¤–ï¼ŒçœŸæ²¡æœ‰åˆ«çš„äº†ã€‚</p>

<p>â€œå…ƒæ³¨è§£â€ï¼Ÿä»€ä¹ˆæ˜¯â€œå…ƒæ³¨è§£â€å‘¢ï¼Ÿ</p>

<p>â€œå…ƒæ³¨è§£â€æ˜¯ç”¨æ¥æ³¨è§£ï¼ˆåŠ¨è¯ï¼‰æ³¨è§£ï¼ˆåè¯ï¼‰çš„æ³¨è§£ï¼ˆåè¯ï¼‰ã€‚è¯·æ„Ÿå—æ±‰è¯­çš„åšå¤§ç²¾æ·±ã€‚<code class="highlighter-rouge">@Target</code>ã€<code class="highlighter-rouge">@Retention</code>å’Œ<code class="highlighter-rouge">@Documented</code>å°±æ˜¯æ‰€è°“çš„å…ƒæ³¨è§£ã€‚</p>

<p>1ï¼‰@Target</p>

<p>Targetæ˜¯ç›®æ ‡çš„æ„æ€ï¼Œ<code class="highlighter-rouge">@Target</code>æŒ‡å®šäº†æ³¨è§£è¿ç”¨çš„åœºæ™¯ã€‚éƒ½æœ‰å“ªäº›åœºæ™¯å€¼å‘¢ï¼Ÿ</p>

<ul>
  <li><code class="highlighter-rouge">ElementType.ANNOTATION_TYPE</code>ï¼šå¯ä»¥ç»™æ³¨è§£è¿›è¡Œæ³¨è§£</li>
  <li><code class="highlighter-rouge">ElementType.CONSTRUCTOR</code>ï¼šå¯ä»¥ç»™æ„é€ æ–¹æ³•è¿›è¡Œæ³¨è§£</li>
  <li><code class="highlighter-rouge">ElementType.FIELD</code>ï¼šå¯ä»¥ç»™å­—æ®µè¿›è¡Œæ³¨è§£</li>
  <li><code class="highlighter-rouge">ElementType.LOCAL_VARIABLE</code>ï¼šå¯ä»¥ç»™å±€éƒ¨å˜é‡è¿›è¡Œæ³¨è§£</li>
  <li><code class="highlighter-rouge">ElementType.METHOD</code>ï¼šå¯ä»¥ç»™æ–¹æ³•è¿›è¡Œæ³¨è§£</li>
  <li><code class="highlighter-rouge">ElementType.PACKAGE</code>ï¼šå¯ä»¥ç»™åŒ…è¿›è¡Œæ³¨è§£</li>
  <li><code class="highlighter-rouge">ElementType.PARAMETER</code>ï¼šå¯ä»¥ç»™æ–¹æ³•å†…çš„å‚æ•°è¿›è¡Œæ³¨è§£</li>
  <li><code class="highlighter-rouge">ElementType.TYPE</code>ï¼šå¯ä»¥ç»™ç±»å‹è¿›è¡Œæ³¨è§£ï¼Œæ¯”å¦‚ç±»ã€æ¥å£å’Œæšä¸¾</li>
</ul>

<p>2ï¼‰@Retention</p>

<p>Retentionè¿™ä¸ªå•è¯çš„æ„æ€ä¸ºä¿ç•™æœŸã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“<code class="highlighter-rouge">@Retention</code>åº”ç”¨åˆ°ä¸€ä¸ªæ³¨è§£ä¸Šçš„æ—¶å€™ï¼Œå®ƒè§£é‡Šè¯´æ˜äº†è¿™ä¸ªæ³¨è§£çš„å­˜æ´»æ—¶é—´ã€‚æ¥çœ‹å®ƒçš„å–å€¼èŒƒå›´ã€‚</p>

<ul>
  <li><code class="highlighter-rouge">RetentionPolicy.SOURCE</code>ï¼šæ³¨è§£åªåœ¨æºç é˜¶æ®µä¿ç•™ï¼Œåœ¨ç¼–è¯‘å™¨è¿›è¡Œç¼–è¯‘æ—¶å®ƒå°†è¢«ä¸¢å¼ƒå¿½è§†ã€‚</li>
  <li><code class="highlighter-rouge">RetentionPolicy.CLASS</code>ï¼šæ³¨è§£åªè¢«ä¿ç•™åˆ°ç¼–è¯‘è¿›è¡Œçš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šè¢«åŠ è½½åˆ° JVM ä¸­ã€‚</li>
  <li><code class="highlighter-rouge">RetentionPolicy.RUNTIME</code>ï¼šæ³¨è§£å¯ä»¥ä¿ç•™åˆ°ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œå®ƒä¼šè¢«åŠ è½½è¿›å…¥åˆ° JVM ä¸­ï¼Œæ‰€ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶å¯ä»¥è·å–åˆ°å®ƒä»¬ã€‚</li>
</ul>

<p>3ï¼‰@Documented</p>

<p><code class="highlighter-rouge">Documented</code>å°±æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œå®ƒå’Œæ–‡æ¡£æœ‰å…³ã€‚ä½œç”¨å°±æ˜¯èƒ½å¤Ÿå°†æ³¨è§£ä¸­çš„å…ƒç´ åŒ…å«åˆ° Javadoc ä¸­ã€‚</p>

<p>å½“æˆ‘ä»¬äº†è§£äº†å…ƒæ³¨è§£çš„æ¦‚å¿µåï¼Œå†å›å¤´çœ‹ä¸€ä¸‹<code class="highlighter-rouge">@CrossOrigin</code>çš„æºç ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰æ¸…æ™°å¤šäº†å‘¢ï¼Ÿ</p>

<p>å¦‚æœèƒ½å¤Ÿç»†è‡´åœ°è¯»ä¸€è¯»æºç ä¸­çš„æ³¨é‡Šï¼Œä½ å°±ä¼šçœ‹åˆ°WebContextFilterç±»ä¸­å‡ºç°çš„å…³é”®å­—ï¼Œè¯¸å¦‚<code class="highlighter-rouge">Access-Control-Allow-Origin</code>ã€<code class="highlighter-rouge">Access-Control-Allow-Headers</code>ã€<code class="highlighter-rouge">Access-Control-Allow-Methods</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬é€šè¿‡<code class="highlighter-rouge">@CrossOrigin</code>å¯¹Controllerç±»æ³¨è§£åï¼ŒSpringMVCå°±èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶å¯¹è¿™ä¸ªç±»è‡ªåŠ¨åŠ ä¸Šè§£å†³è·¨åŸŸé—®é¢˜çš„è¿‡æ»¤å™¨ã€‚</p>

<h3 id="03æ³¨è§£å¯ä»¥åå°„å—">03ã€æ³¨è§£å¯ä»¥åå°„å—ï¼Ÿ</h3>

<p>æ³¨è§£æ˜¯å¯ä»¥é€šè¿‡<a href="http://www.itwanger.com/java/2019/11/08/java-fanshe.html">åå°„</a>è·å–çš„ã€‚</p>

<p>1ï¼‰å¯ä»¥é€šè¿‡ Class å¯¹è±¡çš„ <code class="highlighter-rouge">isAnnotationPresent()</code> æ–¹æ³•åˆ¤æ–­è¯¥ç±»æ˜¯å¦åº”ç”¨äº†æŸä¸ªæŒ‡å®šçš„æ³¨è§£ã€‚</p>

<p>2ï¼‰é€šè¿‡ <code class="highlighter-rouge">getAnnotation()</code> æ–¹æ³•æ¥è·å–æ³¨è§£å¯¹è±¡ã€‚</p>

<p>3ï¼‰å½“è·å–åˆ°æ³¨è§£å¯¹è±¡åï¼Œå°±å¯ä»¥è·å–ä½¿ç”¨æ³¨è§£æ—¶å®šä¹‰çš„å±æ€§å€¼ã€‚</p>

<p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@CrossOrigin</span><span class="o">(</span><span class="n">origins</span> <span class="o">=</span> <span class="s">"http://qingmiaokeji.com"</span><span class="o">,</span> <span class="n">allowedHeaders</span> <span class="o">=</span> <span class="s">"accept,content-type"</span><span class="o">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="o">{</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">POST</span> <span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestController</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">Class</span> <span class="n">c</span> <span class="o">=</span> <span class="nc">TestController</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>

		<span class="k">if</span> <span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">isAnnotationPresent</span><span class="o">(</span><span class="nc">CrossOrigin</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <span class="o">{</span>
			<span class="nc">CrossOrigin</span> <span class="n">crossOrigin</span> <span class="o">=</span> <span class="o">(</span><span class="nc">CrossOrigin</span><span class="o">)</span> <span class="n">c</span><span class="o">.</span><span class="na">getAnnotation</span><span class="o">(</span><span class="nc">CrossOrigin</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">crossOrigin</span><span class="o">.</span><span class="na">allowedHeaders</span><span class="o">()));</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">crossOrigin</span><span class="o">.</span><span class="na">methods</span><span class="o">()));</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">crossOrigin</span><span class="o">.</span><span class="na">origins</span><span class="o">()));</span>
		<span class="o">}</span>

	<span class="o">}</span>
<span class="o">}</span>

<span class="c1">// è¾“å‡ºï¼š[accept,content-type]</span>
<span class="c1">// [GET, POST]</span>
<span class="c1">// [http://qingmiaokeji.com]</span>
</code></pre></div></div>

<h3 id="04æ³¨è§£ç»å¸¸ç”¨åœ¨å“ªé‡Œå‘¢">04ã€æ³¨è§£ç»å¸¸ç”¨åœ¨å“ªé‡Œå‘¢ï¼Ÿ</h3>

<p>1ï¼‰<code class="highlighter-rouge">@Transactional</code>ï¼šSpring ä¸ºäº‹åŠ¡ç®¡ç†æä¾›çš„åŠŸèƒ½æ”¯æŒã€‚</p>

<p>2ï¼‰<code class="highlighter-rouge">@ Service</code>ï¼šSpringåœ¨è¿›è¡ŒåŒ…æ‰«æçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å°†è¿™ä¸ªç±»æ³¨å†Œåˆ°Springå®¹å™¨ä¸­ã€‚</p>

<p>3ï¼‰<code class="highlighter-rouge">@RestController</code>ï¼šæ˜¯<code class="highlighter-rouge">@ResponseBody</code>å’Œ<code class="highlighter-rouge">@Controller</code>çš„ç»„åˆæ³¨è§£ã€‚</p>

<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸‹é¢è¿™æ®µä»£ç ä¸ä¸‹ä¸‹é¢çš„ä»£ç ç­‰åŒã€‚</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloController</span> <span class="o">{</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"hello"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">sayHello</span><span class="o">(){</span>
        <span class="k">return</span> <span class="s">"hello"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Controller</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloController</span> <span class="o">{</span>

    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"hello"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">sayHello</span><span class="o">(){</span>
        <span class="k">return</span> <span class="s">"hello"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>4ï¼‰<code class="highlighter-rouge">@RequestMapping</code> ï¼šSpring Web åº”ç”¨ç¨‹åºä¸­æœ€å¸¸ç”¨åˆ°çš„æ³¨è§£ä¹‹ä¸€ï¼Œå°† HTTP è¯·æ±‚æ˜ å°„åˆ° MVC å’Œ REST æ§åˆ¶å™¨çš„å¤„ç†æ–¹æ³•ä¸Šã€‚</p>

<p>5ï¼‰<code class="highlighter-rouge">@Select</code>ï¼šMyBatisæä¾›çš„æŸ¥è¯¢è¯­å¥æ³¨è§£ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Select</span><span class="o">(</span><span class="s">"select * from city"</span><span class="o">)</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">City</span><span class="o">&gt;</span> <span class="nf">getCitys</span><span class="o">();</span>
</code></pre></div></div>

<p>6ï¼‰è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šï¼Œå°±ä¸å†ä¸€ä¸€åˆ—ä¸¾äº†ã€‚</p>

<h3 id="05æœ€å">05ï¼‰æœ€å</h3>

<p>æˆ‘æƒ³è¯´çš„æ˜¯ï¼Œæ³¨è§£æœ‰è®¸å¤šç”¨å¤„ï¼Œä¸»è¦æœ‰ï¼š</p>

<ul>
  <li>æä¾›ä¿¡æ¯ç»™ç¼–è¯‘å™¨ï¼š ç¼–è¯‘å™¨å¯ä»¥åˆ©ç”¨æ³¨è§£æ¥æ¢æµ‹é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯ã€‚</li>
  <li>ç¼–è¯‘é˜¶æ®µæ—¶çš„å¤„ç†ï¼š  è½¯ä»¶å·¥å…·å¯ä»¥åˆ©ç”¨æ³¨è§£ä¿¡æ¯æ¥ç”Ÿæˆä»£ç ã€HTMLæ–‡æ¡£ã€‚</li>
  <li>è¿è¡Œæ—¶çš„å¤„ç†ï¼š  æŸäº›æ³¨è§£å¯ä»¥åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™æ¥å—ä»£ç çš„æå–ã€‚</li>
</ul>

<hr />

<p>ä¸Šä¸€ç¯‡ï¼š<a href="http://www.itwanger.com/java/2019/11/09/java-enum.html">Javaæšä¸¾ï¼šå°å°enumï¼Œä¼˜é›…è€Œå¹²å‡€</a></p>

<p>ä¸‹ä¸€ç¯‡ï¼š<a href="http://www.itwanger.com/java/2019/11/09/java-io.html">Java I/O å…¥é—¨ç¯‡</a></p>

<p>å¾®ä¿¡æœç´¢ã€Œ<strong>æ²‰é»˜ç‹äºŒ</strong>ã€å…¬ä¼—å·ï¼Œå…³æ³¨åå›å¤ã€Œ<strong>å…è´¹è§†é¢‘</strong>ã€è·å– 500G é«˜è´¨é‡æ•™å­¦è§†é¢‘ï¼ˆ<a href="https://mp.weixin.qq.com/s/GjkEyPW0vgIvuDLYQkBM0A">å·²åˆ†é—¨åˆ«ç±»</a>ï¼‰ã€‚</p>

:ET